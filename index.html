<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yerel DepolamalÄ± AraÃ§ Envanteri YÃ¶netimi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter fontu ve temel arkaplan stilini uygula */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Daha aÃ§Ä±k ve sade arkaplan */
        }
        /* MasaÃ¼stÃ¼ gÃ¶rÃ¼nÃ¼mÃ¼nde form ve listenin yan yana olmasÄ± iÃ§in stil */
        @media (min-width: 1024px) {
            /* Form gÃ¶sterildiÄŸinde (gizlenmediÄŸinde) 1/3 - 2/3 oranÄ±nda yan yana durur */
            .main-layout:not(.has-hidden-form) {
                grid-template-columns: 1fr 2fr; 
            }
        }
        /* Tablo hÃ¼crelerinde dikey hizalamayÄ± ayarla */
        .table-cell {
            vertical-align: middle;
        }
        /* Input focus halkasÄ± iÃ§in Ã¶zel renk (Tailwind varsayÄ±lan) */
        .input-focus:focus {
            --tw-ring-color: #3b82f6; /* Blue-500 */
        }
    </style>
    </head>
<body class="p-4 lg:p-10">

    <script>
        // Sabitler
        const VEHICLES_KEY = 'corporate_vehicles_inventory'; // localStorage anahtarÄ±
        
        // UI Elementleri
        const vehicleForm = document.getElementById('vehicleForm');
        const vehicleListBody = document.getElementById('vehicleListBody');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const searchInput = document.getElementById('searchInput');
        // userIdDisplay yerine doÄŸrudan yerel depolama durumu gÃ¶steriliyor
        
        // Form ve Liste Kontrol Elementleri
        const mainLayout = document.getElementById('mainLayout');
        const toggleFormButton = document.getElementById('toggleFormButton');
        const formSection = document.getElementById('formSection');
        const listSection = document.getElementById('listSection');
        const plusIcon = document.getElementById('plusIcon');
        const minusIcon = document.getElementById('minusIcon');
        
        // Toplu Ekleme Elementleri
        const singleEntryTabBtn = document.getElementById('singleEntryTabBtn');
        const bulkImportTabBtn = document.getElementById('bulkImportTabBtn');
        const singleEntryArea = document.getElementById('singleEntryArea');
        const bulkImportArea = document.getElementById('bulkImportArea');
        const bulkDataInput = document.getElementById('bulkDataInput');
        const bulkImportButton = document.getElementById('bulkImportButton');
        const bulkFileInput = document.getElementById('bulkFileInput');

        let vehiclesData = []; // UygulamanÄ±n ana veri yapÄ±sÄ±

        /**
         * Bildirim GÃ¶sterme Fonksiyonu
         * @param {string} message GÃ¶sterilecek mesaj
         * @param {'success' | 'error' | 'info'} type Bildirim tÃ¼rÃ¼
         */
        function showNotification(message, type = 'success') {
            const container = document.getElementById('notificationContainer');
            const color = type === 'success' ? 'bg-green-500' : (type === 'error' ? 'bg-red-500' : 'bg-blue-500');

            const notification = document.createElement('div');
            notification.className = `${color} text-white px-4 py-3 rounded-xl shadow-lg mb-2 opacity-0 transform transition-all duration-300 translate-y-4 max-w-sm`;
            notification.innerHTML = `<p class="font-bold">${type === 'success' ? 'BaÅŸarÄ±lÄ±' : (type === 'error' ? 'Hata' : 'Bilgi')}:</p><div class="text-sm mt-1">${message}</div>`;

            container.appendChild(notification);

            setTimeout(() => {
                notification.classList.remove('opacity-0', 'translate-y-4');
            }, 10);

            setTimeout(() => {
                notification.classList.add('opacity-0', 'translate-y-4');
                notification.addEventListener('transitionend', () => notification.remove());
            }, 6000); 
        }

        // 1. Yerel Depolamadan Verileri YÃ¼kle
        function loadVehicles() {
            try {
                const storedVehicles = localStorage.getItem(VEHICLES_KEY);
                if (storedVehicles) {
                    vehiclesData = JSON.parse(storedVehicles);
                } else {
                     vehiclesData = []; 
                }
            } catch (error) {
                console.error("Yerel depolamadan yÃ¼klenirken hata oluÅŸtu:", error);
                showNotification("Yerel verileriniz yÃ¼klenirken bir hata oluÅŸtu. TarayÄ±cÄ± ayarlarÄ±nÄ±zÄ± kontrol edin.", 'error');
                vehiclesData = [];
            }
            
            // Verileri createdAt (yaratÄ±lÄ±ÅŸ zamanÄ±) ile tersten sÄ±rala (en yeni Ã¼stte)
            vehiclesData.sort((a, b) => b.createdAt - a.createdAt);
            filterAndRenderVehicles(); 
            loadingIndicator.classList.add('hidden');
        }

        // 2. Verileri Yerel Depolamaya Kaydet
        function saveVehicles() {
            try {
                localStorage.setItem(VEHICLES_KEY, JSON.stringify(vehiclesData));
            } catch (error) {
                console.error("Yerel depolamaya kaydederken hata oluÅŸtu:", error);
                showNotification("Veriler yerel depolamaya kaydedilirken hata oluÅŸtu. Depolama alanÄ± dolu olabilir.", 'error');
            }
        }

        // PoliÃ§e BitiÅŸinin YakÄ±n Olup OlmadÄ±ÄŸÄ±nÄ± Kontrol Et (90 gÃ¼nden az kaldÄ±ysa)
        function isPolicyExpiringSoon(policyDate) {
            const today = new Date();
            const diffTime = policyDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            return diffDays > 0 && diffDays < 90; // BugÃ¼n ile poliÃ§e bitiÅŸi arasÄ±nda 1-89 gÃ¼n varsa
        }
        
        // AraÃ§ Listesini HTML'e Ã‡izme Fonksiyonu
        function renderVehicles(vehicles) {
            vehicleListBody.innerHTML = ''; 
            
            if (vehicles.length === 0) {
                const searchTerm = searchInput.value.trim();
                const message = searchTerm 
                    ? `"${searchTerm}" ile eÅŸleÅŸen araÃ§ bulunamadÄ±.` 
                    : `HenÃ¼z kayÄ±tlÄ± araÃ§ bulunmamaktadÄ±r. Yerel depolama kullanÄ±lÄ±yor.`;
                vehicleListBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="p-4 text-center text-gray-400 italic">
                            ${message}
                        </td>
                    </tr>
                `;
                return;
            }

            vehicles.forEach(vehicle => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100 hover:bg-blue-50/50 transition duration-200';

                // PoliÃ§e BitiÅŸ Tarihi, zaten YYYY-MM-DD string olarak bekleniyor
                const policyDateValue = new Date(vehicle.policyEnd); 

                const formattedDate = isNaN(policyDateValue) ? 'Tarih Yok' : policyDateValue.toLocaleDateString('tr-TR', { year: 'numeric', month: 'short', day: 'numeric' });
                
                const expiringSoon = isPolicyExpiringSoon(policyDateValue);
                const badgeClasses = expiringSoon 
                    ? 'bg-red-500 text-white shadow-md font-extrabold' 
                    : 'bg-green-100 text-green-700 font-semibold'; 

                row.innerHTML = `
                    <td class="px-2 py-3 sm:p-4 table-cell font-bold text-gray-800">${vehicle.model}</td>
                    <td class="px-2 py-3 sm:p-4 table-cell font-mono text-sm text-gray-600">${vehicle.plate}</td>
                    <td class="px-2 py-3 sm:p-4 table-cell text-gray-700">${vehicle.driver}</td>
                    <td class="px-2 py-3 sm:p-4 table-cell text-sm text-gray-500">${vehicle.unit}</td>
                    <td class="px-2 py-3 sm:p-4 table-cell whitespace-nowrap">
                        <span class="inline-block py-1 px-3 text-xs rounded-full ${badgeClasses}">
                            ${formattedDate}
                            ${expiringSoon ? ' (YAKINDA BÄ°TÄ°YOR)' : ''}
                        </span>
                    </td>
                    <td class="px-2 py-3 sm:p-4 table-cell text-right">
                        <button data-id="${vehicle.id}" class="delete-btn text-red-600 hover:text-white bg-red-100 hover:bg-red-500 p-2 rounded-full transition duration-200 shadow-md" title="AracÄ± Sil">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                        </button>
                    </td>
                `;
                vehicleListBody.appendChild(row);
            });

            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const id = e.currentTarget.dataset.id;
                    // KullanÄ±cÄ±ya onay soran Ã¶zel bir modal UI kullanÄ±n
                    if (window.confirm("Bu aracÄ± gerÃ§ekten silmek istiyor musunuz? Geri alÄ±namaz bir iÅŸlemdir.")) {
                         deleteVehicle(id);
                    }
                });
            });
        }
        
        // Yerel Depolamaya Tekli AraÃ§ Ekleme
        function addVehicle(vehicleData) {
            
            // Firestore'daki serverTimestamp yerine yerel zaman kullan
            const newVehicle = {
                ...vehicleData,
                id: Date.now().toString(), // Basit benzersiz kimlik (string olarak)
                createdAt: Date.now() // SÄ±ralama iÃ§in epoch time
            };
        
            vehiclesData.push(newVehicle);
            
            // SÄ±ralama ve kaydetme
            vehiclesData.sort((a, b) => b.createdAt - a.createdAt); 
            saveVehicles();
            filterAndRenderVehicles();

            showNotification(`'${vehicleData.model}' baÅŸarÄ±yla envantere eklendi.`, 'success');
            vehicleForm.reset(); 
            hideForm();
        }

        // Yerel Depolamadan AraÃ§ Silme
        function deleteVehicle(id) {
            const initialLength = vehiclesData.length;
            // ID'ye gÃ¶re filtrele (silmek istediÄŸimizi listeden Ã§Ä±kar)
            vehiclesData = vehiclesData.filter(vehicle => vehicle.id !== id);
            
            if (vehiclesData.length < initialLength) {
                saveVehicles();
                filterAndRenderVehicles();
                showNotification("AraÃ§ baÅŸarÄ±yla envanterden silindi.", 'success');
            } else {
                showNotification("Silinecek araÃ§ bulunamadÄ±. Liste gÃ¼ncel olmayabilir.", 'error');
            }
        }
        
        // Tablar ArasÄ±nda GeÃ§iÅŸ Fonksiyonu
        function switchTab(target) {
            // Tailwind sÄ±nÄ±flarÄ±nÄ± yÃ¶netme
            const activeClasses = ['border-blue-600', 'text-blue-600'];
            const inactiveClasses = ['border-transparent', 'text-gray-500'];
            const hoverClasses = ['hover:text-blue-600', 'hover:border-blue-300'];

            if (target === 'single') {
                singleEntryArea.classList.remove('hidden');
                bulkImportArea.classList.add('hidden');
                
                singleEntryTabBtn.classList.add(...activeClasses);
                singleEntryTabBtn.classList.remove(...inactiveClasses, ...hoverClasses);
                
                bulkImportTabBtn.classList.remove(...activeClasses);
                bulkImportTabBtn.classList.add(...inactiveClasses, ...hoverClasses);
            } else {
                bulkImportArea.classList.remove('hidden');
                singleEntryArea.classList.add('hidden');

                bulkImportTabBtn.classList.add(...activeClasses);
                bulkImportTabBtn.classList.remove(...inactiveClasses, ...hoverClasses);
                
                singleEntryTabBtn.classList.remove(...activeClasses);
                singleEntryTabBtn.classList.add(...inactiveClasses, ...hoverClasses);
            }
        }

        // Formu Gizle Fonksiyonu (Mobil iÃ§in kritik)
        function hideForm() {
            formSection.classList.add('hidden');
            // listSection.classList.add('lg:col-span-2'); // CSS'deki media query hallediyor
            mainLayout.classList.add('has-hidden-form'); // CSS'e Ã¶zel sÄ±nÄ±f ekle
            toggleFormButton.classList.remove('bg-red-500', 'hover:bg-red-600', 'focus:ring-red-300');
            toggleFormButton.classList.add('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300');
            plusIcon.classList.remove('hidden');
            minusIcon.classList.add('hidden');
        }

        // Formu GÃ¶ster Fonksiyonu
        function showForm() {
            formSection.classList.remove('hidden');
            // listSection.classList.remove('lg:col-span-2'); // CSS'deki media query hallediyor
            mainLayout.classList.remove('has-hidden-form'); // CSS'e Ã¶zel sÄ±nÄ±fÄ± kaldÄ±r
            toggleFormButton.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'focus:ring-blue-300');
            toggleFormButton.classList.add('bg-red-500', 'hover:bg-red-600', 'focus:ring-red-300');
            plusIcon.classList.add('hidden');
            minusIcon.classList.remove('hidden');
        }
        
        // Filtreleme ve Ã‡izme Fonksiyonu
        function filterAndRenderVehicles() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (!searchTerm) {
                renderVehicles(vehiclesData); 
                return;
            }

            const filtered = vehiclesData.filter(vehicle => {
                
                // PoliÃ§e bitiÅŸ tarihi YYYY-MM-DD string olarak gelir.
                const policyEndString = vehicle.policyEnd || ''; 

                return vehicle.model.toLowerCase().includes(searchTerm) ||
                       vehicle.plate.toLowerCase().includes(searchTerm) ||
                       vehicle.driver.toLowerCase().includes(searchTerm) ||
                       vehicle.unit.toLowerCase().includes(searchTerm) ||
                       policyEndString.toLowerCase().includes(searchTerm); 

            });

            renderVehicles(filtered);
        }

        // Toplu Ä°Ã§e AktarÄ±mÄ± YÃ¶netme Fonksiyonu
        async function handleBulkImport() {
            let rawData = '';

            // 1. Dosya YÃ¼klemesi KontrolÃ¼
            if (bulkFileInput.files.length > 0) {
                const file = bulkFileInput.files[0];
                showNotification(`'${file.name}' dosyasÄ± okunuyor...`, 'info');
                
                try {
                    rawData = await new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = (event) => resolve(event.target.result);
                        reader.onerror = (error) => reject(error);
                        reader.readAsText(file, 'UTF-8');
                    });
                } catch (e) {
                    console.error("Dosya okuma hatasÄ±:", e);
                    showNotification("Dosya okuma sÄ±rasÄ±nda bir hata oluÅŸtu.", 'error');
                    return;
                }
            } else {
                // 2. Textarea KontrolÃ¼ (Dosya yoksa)
                rawData = bulkDataInput.value.trim();
            }

            if (!rawData) {
                showNotification("LÃ¼tfen iÃ§e aktarÄ±lacak verileri girin veya bir dosya seÃ§in.", 'error');
                return;
            }

            const lines = rawData.split('\n').filter(line => line.trim() !== '');
            let successCount = 0;
            let failedCount = 0;
            const errorMessages = [];
            const vehiclesToAdd = [];

            showNotification(`Toplam ${lines.length} araÃ§ satÄ±rÄ± iÅŸleniyor...`, 'info');

            // Toplu eklemede benzersiz ID saÄŸlamak iÃ§in baÅŸlangÄ±Ã§ zamanÄ±nÄ± al
            const baseTimestamp = Date.now(); 

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i];
                // CSV'nin temel ayrÄ±ÅŸtÄ±rmasÄ± (tÄ±rnak iÅŸaretlerini dikkate almaz)
                const parts = line.split(',').map(p => p.trim()); 

                if (parts.length !== 5) {
                    failedCount++;
                    errorMessages.push(`SatÄ±r ${i + 1} (${line.substring(0, 20)}...): Eksik veya fazla alan (5 bekleniyor).`);
                    continue;
                }

                const [model, plate, driver, unit, policyEnd] = parts;
                
                // Plaka ve Modelin boÅŸ olmamasÄ± temel kontrolÃ¼
                if (!model || !plate) {
                    failedCount++;
                    errorMessages.push(`SatÄ±r ${i + 1} (${plate || model}): Model veya Plaka boÅŸ bÄ±rakÄ±lamaz.`);
                    continue;
                }

                // PoliÃ§e BitiÅŸ Tarihi KontrolÃ¼ (YYYY-MM-DD formatÄ± ve geÃ§erli tarih)
                if (!/^\d{4}-\d{2}-\d{2}$/.test(policyEnd) || isNaN(new Date(policyEnd))) {
                    failedCount++;
                    errorMessages.push(`SatÄ±r ${i + 1} (${plate}): GeÃ§ersiz poliÃ§e bitiÅŸ tarihi formatÄ± (YYYY-MM-DD bekleniyor).`);
                    continue;
                }
                
                vehiclesToAdd.push({
                    model,
                    plate,
                    driver,
                    unit,
                    policyEnd: policyEnd, 
                    id: (baseTimestamp + i).toString(), // Toplu eklemede basit benzersiz ID saÄŸlamak iÃ§in
                    createdAt: baseTimestamp + i // SÄ±ralama iÃ§in epoch time
                });
                successCount++;
            }
            
            // BaÅŸarÄ±lÄ± eklemeleri ana listeye ekle
            vehiclesData = [...vehiclesData, ...vehiclesToAdd];
            
            // Kaydet ve render et
            vehiclesData.sort((a, b) => b.createdAt - a.createdAt);
            saveVehicles();
            filterAndRenderVehicles();


            let summaryMessage = `BaÅŸarÄ±lÄ±: ${successCount} araÃ§ eklendi.`;
            let summaryType = 'success';

            if (failedCount > 0) {
                summaryMessage = `BaÅŸarÄ±lÄ±: ${successCount} araÃ§ eklendi. HATA: ${failedCount} araÃ§ eklenemedi. DetaylarÄ± konsolu kontrol edin.`;
                summaryType = 'error';
                console.error("Toplu Ä°Ã§e Aktarma DetaylÄ± HatalarÄ±:", errorMessages);
            }
            
            showNotification(summaryMessage, summaryType);
            
            if (successCount > 0) {
                bulkDataInput.value = ''; 
                bulkFileInput.value = ''; 
            }
            
            // Ä°ÅŸlem bitince formu gizle
            hideForm();
        }
        
        // Form GÃ¶nderimini YÃ¶netme (Tekli GiriÅŸ)
        function handleSingleEntrySubmit(e) {
            e.preventDefault();
            
            const model = document.getElementById('model').value.trim();
            const plate = document.getElementById('plate').value.trim();
            const driver = document.getElementById('driver').value.trim();
            const unit = document.getElementById('unit').value.trim();
            const policyEnd = document.getElementById('policyEnd').value.trim(); 

            // Basit Alan KontrolÃ¼
            if (!model || !plate || !driver || !unit || !policyEnd) {
                showNotification("LÃ¼tfen tÃ¼m alanlarÄ± doldurun.", 'error');
                return;
            }
            
            // Tarih KontrolÃ¼
            if (isNaN(new Date(policyEnd))) {
                showNotification("GeÃ§ersiz PoliÃ§e BitiÅŸ Tarihi.", 'error');
                return;
            }

            const vehicleData = { model, plate, driver, unit, policyEnd };
            
            addVehicle(vehicleData);
        }


        // Uygulama BaÅŸlatma Fonksiyonu
        function initApp() {
            
            // Firebase'e ait UI elementini gizle veya kaldÄ±r (Geri uyumluluk iÃ§in)
            const userIdDisp = document.getElementById('userIdDisplay');
            if (userIdDisp) {
                userIdDisp.textContent = "BaÄŸlantÄ±: Yerel Depolama (localStorage)";
                userIdDisp.classList.remove('text-gray-500', 'bg-gray-100');
                userIdDisp.classList.add('text-indigo-700', 'bg-indigo-100');
            }


            // Olay dinleyicilerini ayarla
            toggleFormButton.addEventListener('click', () => {
                const isHidden = formSection.classList.contains('hidden');
                if (isHidden) { showForm(); } else { hideForm(); }
            });
            vehicleForm.addEventListener('submit', handleSingleEntrySubmit);
            singleEntryTabBtn.addEventListener('click', () => switchTab('single'));
            bulkImportTabBtn.addEventListener('click', () => switchTab('bulk'));
            bulkImportButton.addEventListener('click', handleBulkImport);
            searchInput.addEventListener('input', filterAndRenderVehicles);
            
            // Verileri yÃ¼kle
            loadVehicles();

            // BaÅŸlangÄ±Ã§ta formu gizle
            hideForm();
        }

        // UygulamayÄ± baÅŸlat
        window.onload = initApp;

    </script>

    <header class="mb-8 flex flex-col lg:flex-row justify-between items-start lg:items-center">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">ðŸš— Yerel AraÃ§ Envanteri YÃ¶netimi</h1>
        
        <div class="mb-4 text-sm text-gray-500">
            <span id="userIdDisplay" class="font-mono text-xs p-2 rounded-xl bg-gray-100 transition duration-300">Durum: Yerel Depolama (localStorage)</span>
        </div>
    </header>

    <div id="notificationContainer" class="fixed top-4 right-4 z-50 flex flex-col items-end space-y-2">
        </div>

    <main id="mainLayout" class="grid grid-cols-1 gap-8 main-layout">
        
        <section id="formSection" class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 lg:sticky lg:top-10 h-min transition-all duration-300 ease-in-out">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3 text-blue-600">Yeni AraÃ§ KaydÄ±</h2>

            <div class="flex mb-6 border-b border-gray-200">
                <button id="singleEntryTabBtn" class="py-2 px-4 text-sm font-semibold border-b-2 border-blue-600 text-blue-600 transition duration-150 focus:outline-none">Tekli GiriÅŸ</button>
                <button id="bulkImportTabBtn" class="py-2 px-4 text-sm font-semibold border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300 transition duration-150 focus:outline-none">Toplu Ekleme</button>
            </div>
            
            <div id="singleEntryArea">
                <form id="vehicleForm" class="space-y-5">
                    
                    <div>
                        <label for="model" class="block text-sm font-medium text-gray-700 mb-1">AraÃ§ Modeli <span class="text-red-500">*</span></label>
                        <input type="text" id="model" name="model" required class="input-focus w-full px-4 py-2 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20" placeholder="Ã–rn: Ford Focus">
                    </div>

                    <div>
                        <label for="plate" class="block text-sm font-medium text-gray-700 mb-1">Plaka <span class="text-red-500">*</span></label>
                        <input type="text" id="plate" name="plate" required class="input-focus w-full px-4 py-2 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20" placeholder="Ã–rn: 34 ABC 123">
                    </div>

                    <div>
                        <label for="driver" class="block text-sm font-medium text-gray-700 mb-1">Kullanan KiÅŸi <span class="text-red-500">*</span></label>
                        <input type="text" id="driver" name="driver" required class="input-focus w-full px-4 py-2 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20" placeholder="Ã–rn: Ali YÄ±lmaz">
                    </div>

                    <div>
                        <label for="unit" class="block text-sm font-medium text-gray-700 mb-1">Birim (Departman) <span class="text-red-500">*</span></label>
                        <input type="text" id="unit" name="unit" required class="input-focus w-full px-4 py-2 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20" placeholder="Ã–rn: SatÄ±ÅŸ, Muhasebe">
                    </div>

                    <div>
                        <label for="policyEnd" class="block text-sm font-medium text-gray-700 mb-1">PoliÃ§e BitiÅŸ Tarihi <span class="text-red-500">*</span></label>
                        <input type="date" id="policyEnd" name="policyEnd" required class="input-focus w-full px-4 py-2 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20">
                    </div>

                    <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-xl transition duration-300 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-green-300 focus:ring-opacity-50 mt-6">
                        AracÄ± Envantere Kaydet
                    </button>
                </form>
            </div>

            <div id="bulkImportArea" class="hidden">
                <p class="text-sm text-gray-700 mb-4 bg-yellow-50 p-4 rounded-xl border border-yellow-200">
                    Verileri **CSV dosyasÄ± (.csv)** ile yÃ¼kleyebilir veya aÅŸaÄŸÄ±daki alana yapÄ±ÅŸtÄ±rabilirsiniz. <br>
                    <span class="font-semibold text-yellow-800">Gerekli Alan SÄ±rasÄ±: </span> <code class="font-mono text-sm text-red-700">Model, Plaka, SÃ¼rÃ¼cÃ¼, Birim, PoliÃ§e BitiÅŸ (YYYY-MM-DD)</code>
                </p>
                
                <div class="mb-5 p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 transition duration-150">
                    <label for="bulkFileInput" class="block text-sm font-medium text-gray-700 mb-2">CSV DosyasÄ± YÃ¼kle (.csv)</label>
                    <input type="file" id="bulkFileInput" accept=".csv" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                </div>

                <div class="relative mb-4">
                    <div class="absolute inset-0 flex items-center" aria-hidden="true">
                        <div class="w-full border-t border-gray-300"></div>
                    </div>
                    <div class="relative flex justify-center">
                        <span class="px-2 bg-white text-sm text-gray-500">
                            veya YapÄ±ÅŸtÄ±r
                        </span>
                    </div>
                </div>

                <textarea id="bulkDataInput" rows="5" class="input-focus w-full px-4 py-2 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20 font-mono text-sm resize-none" placeholder="Ã–rn:\nOpel Corsa, 34 XYZ 456, Mehmet Kaya, Muhasebe, 2026-11-15\nVW Passat, 06 ABC 123, Zeynep Demir, SatÄ±ÅŸ, 2025-08-01"></textarea>

                <button id="bulkImportButton" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 rounded-xl transition duration-300 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-indigo-300 focus:ring-opacity-50 mt-4">
                    Toplu Ä°Ã§e AktarÄ±mÄ± BaÅŸlat
                </button>
            </div>


        </section>
        
        <section id="listSection" class="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
            
            <div class="flex justify-between items-center mb-6 border-b pb-3">
                <h2 class="text-2xl font-bold text-gray-800 text-indigo-600">KayÄ±tlÄ± AraÃ§lar Listesi</h2>
                
                <button id="toggleFormButton" title="Yeni AraÃ§ Ekle/Formu Gizle" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full transition duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-300 flex items-center justify-center">
                    <svg id="plusIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                    <svg id="minusIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>
                </button>
            </div>
            
            <div class="mb-6">
                <input type="text" id="searchInput" placeholder="Model, plaka, sÃ¼rÃ¼cÃ¼, birim veya poliÃ§e bitiÅŸ tarihine gÃ¶re ara..." class="input-focus w-full px-4 py-3 border border-gray-300 rounded-xl shadow-inner transition duration-150 focus:ring-4 focus:ring-opacity-20">
            </div>

            <div id="loadingIndicator" class="text-center py-12 text-blue-500 font-semibold text-lg">
                Veriler Yerel Depolamadan YÃ¼kleniyor...
            </div>

            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50 border-b-2 border-gray-200">
                        <tr>
                            <th scope="col" class="px-2 py-3 sm:p-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Model</th>
                            <th scope="col" class="px-2 py-3 sm:p-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Plaka</th>
                            <th scope="col" class="px-2 py-3 sm:p-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Kullanan KiÅŸi</th>
                            <th scope="col" class="px-2 py-3 sm:p-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Birim</th>
                            <th scope="col" class="px-2 py-3 sm:p-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">PoliÃ§e BitiÅŸ</th>
                            <th scope="col" class="px-2 py-3 sm:p-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider">Aksiyon</th>
                        </tr>
                    </thead>
                    <tbody id="vehicleListBody" class="bg-white divide-y divide-gray-200">
                        </tbody>
                </table>
            </div>
        </section>

    </main>

</body>
</html>
